# 简介
本项目在**廖锦程**工程代码的基础上用_**C++**_重构了CAN与PID底层，同时重构了大疆、达妙电机底层，编写了瓴控电机驱动。感谢**魏炳文**的debug陪伴与巧妙的父类虚写子类继承思想，让我得以完成此项目，但现阶段仍有不足，后续会继续完善。希望该底层能够帮助到大家更好的编写代码。
本项目使用的开发板为RoboMaster C型开发板，IO口配置详情见RoboMaster官网C型开发板用户使用说明书。
# 文件结构
本项目分为Task、Driver、BSP三个主文件夹，其中：
- Task为任务层，FreeRTOS主要的任务被编写在这里，目前只有一个闪烁灯与电机测试显式任务，隐式任务被放在User_Driver层中
- User_Driver为驱动层，电机驱动与PID被编写在这里
- BSP为硬件底层，CAN的接收和发送配置被编写在这里
# 电机驱动大致思路
由于所有电机类几乎都围绕着motor_set_speed()、motor_set_rounds()等统一目的的函数作相关的代码编写，于是我们希望能用一个统一的名字来实现此目的。在廖锦程的代码中，他使用了**函数指针**来完成这一目的。但是由于函数指针可读性过差，而在C++中，**函数重构**与该目的及其重合，于是便有了此次代码重构。我决定使用各电机种类为子类，统一继承并覆写motor_dev父类来实现此目的。但所有电机同样涉及一个共同问题即正反转问题，能不能将它也统一处理而不让代码显得臃肿优美呢？受于**魏炳文**的点拨，一个嵌套思路浮现出来。_**即各个电机种类中只负责处理正转，正反转由父类处理，用户在子类中调用父类的函数，父类中再调用自己的虚函数，由于虚函数被子类覆写所以又会跳转到子类的各个执行函数中去**_。基于此思想与锦程的架构，我编写出了这一套底层，希望大家能用的方便！
# 现存问题与想添加的东西
- 瓴控电机的位置环还有问题
- 后续可能会添加串口舵机的驱动